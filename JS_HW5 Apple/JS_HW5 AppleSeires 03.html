<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./grid.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <style>
        .pic-box{
            position: sticky;
            top: 115px;
            /* border: 2px solid #ccc; */
            box-shadow: 0 0px 0px 0 rgba(0, 0, 0, 0.111), 0 0px 10px 0 rgba(0, 0, 0, 0.19);
            border-radius: 20px;
            overflow: hidden;
        }
        .pic{
            width: 100%;
            display: block;
            /* position: sticky;
            top: 0; */
        }

        .list{
            margin: auto;
            display: flex;
            /* flex-direction: row; */
            flex-wrap: wrap;
            /* justify-content: center; */
        }
        .section-title{
            width: 100%;
        }
        .card{
            /* min-width: 150px;
            max-width: 280px; */
            border:1px solid #ccc;
            border-radius: 10px;
            text-align: center;
            padding: 20px;
            /* display: flex;
            place-content: center; */
        }
        .card:hover{
            border:1.5px solid rgba(61, 109, 255, 0.461);
        }
        button{
            width: 100%;
            border: none;
            border-radius: 20px;
            padding: 10px;
            background-color: rgb(61, 109, 255);
            color: white;
        }
        
        .circle{
            width: 40px;
            height: 40px;
            border-radius: 30px;
            margin: auto; 
        }
       
        h5{
            margin-top: 20px;
        }
        h5 span{
            font-size: 10px;
            color: #646464;
            display: block;
            margin: 10px;
        }
        .price-box{
            font-size: 30px;
            border: none;
        }

        .navbar{
            position: sticky;
            top: 0px;
            z-index: 1;
        }
        .nav-link{
            width: 150px;
            text-align: center;
        }
        .nav-link:hover{
            color: rgb(61, 109, 255);
            border-radius: 20px;
            font-weight: bolder;
        }
        </style>
</head>
<body>
    
    
    <!-- navbar 區域 -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <!-- 不要滿版 <div class="container-fluid"> -->
        <div class="container">
        <a class="navbar-brand" href="#">apple</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mx-auto">

              <!-- <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li> -->

              <li class="nav-item">
                <a class="nav-link" href="#" id="ipad">iPad</a>
              </li>

              <li class="nav-item">
                <a class="nav-link" href="#" id="iphone">iPhone</a>
              </li>

              <li class="nav-item">
                <a class="nav-link" href="#" id="mac">Mac</a>
              </li>

            </ul>
     
          </div>
        </div>
      </nav>    
</header>
  

    <!-- 圖片+選項區塊 -->
    <div class="container main-container">
        <div class="row">
            <!-- 圖片區 -->
            <div class="col-12 col-md-6 col-lg-6 col-xl-6">
                <div class="pic-box">
                    <img class="pic" src="https://raw.githubusercontent.com/hyeb407/FileStorage-02/main/iPadAir%20pics/iPad_air%2001.jpg" alt="">
                </div>
            </div>
                
            <!-- 顏色選項 -->
            <div class="sub-container col-12 col-md-6 col-lg-6 col-xl-6">
                <section class="list col-12 col-md-12 col-lg-12 col-xl-12" id="styleBtnSection">
                    <div class="section-title">機型。<span> 哪一款最適合你？</span></div>
                      
                </section>

                <section class="list col-12 col-md-12 col-lg-12 col-xl-12" id="colorBtnSection">
                    <div class="section-title">外觀。<span>挑選喜愛的顏色。</span></div>
                        <!-- <div class="col-6 col-md-6 col-lg-6 col-xl-6">
                            <div class="card colorBtn" id="太空灰色">
                                <div class="circle gray"></div>
                                <h5 class="colorBtnName">太空灰</h5>   
                            </div>
                        </div>
                        
                        <div class="col-6 col-md-6 col-lg-6 col-xl-6">
                            <div class="card colorBtn" id="銀色">
                                <div class="circle silver"></div>
                                <h5 class="colorBtnName">銀色</h5>               
                            </div>
                        </div>                    -->
                </section>
            
   
                <!-- 儲存裝置選項 -->
                <section class="list col-12 col-md-12 col-lg-12 col-xl-12" id="storageBtnSection">          
                    <div class="section-title">儲存空間</div>
                         
                </section>
                
 
                <!-- 連線能力 network 選項 -->
                <section class="list col-12 col-md-12 col-lg-12 col-xl-12" id="networkBtnSection">            
                    <div class="section-title">連線能力</div>
                        <!-- <div class="col-12 col-md-12 col-lg-12 col-xl-12">
                            <div class="card networkBtn" id="Wi-Fi">
                                <h5 class="networkBtnName">Wi-Fi<span>每部 iPad 都可連接到 Wi-Fi 網路，使你能保持連線。 </span></h5>   
                            </div>
                        </div>
                        
                        <div class="ol-12 col-md-12 col-lg-12 col-xl-12">
                            <div class="card networkBtn" id="Cellular">
                                <h5 class="networkBtnName">Wi-Fi + 行動網路<span>Wi-Fi + 行動網路機型讓你在無法使用 Wi-Fi 時也能進行連線。</span></h5>               
                            </div>
                        </div> -->
                </section>
                                     
                <!-- 價格試算 -->
                <section class="list col-12 col-md-12 col-lg-12 col-xl-12">
                    <div class="section-title">價格試算</div>
                        <div class="col-12 col-md-12 col-lg-12 col-xl-12">
                            <div class="card price-box" id="">NT$19,000 起</div>
                            <div class="col-12 col-md-12 col-lg-12 col-xl-12">
                                <button>繼續</button>
                            </div>
                        </div>
                </section>
            </div>
        </div>
    </div>

    <!-- 定義一個 Template  -->
   
    <template id="cardBtnColor">
        <div class="col-6 col-md-6 col-lg-6 col-xl-6">
            <div class="card colorBtn cardTemp" id="每個按鈕的ID">
                <!-- <div class="circle circleTemp"></div> -->
                <img src="" class="circle circleTemp">
                <h5 class="colorBtnName colorNameTemp">公版文字</h5>   
            </div>
        </div>
    </template>

    <template id="cardBtn">
        <div class="col-6 col-md-6 col-lg-6 col-xl-6">                             
            <div class="card cardTemp2" id="每個按鈕的ID">
                <h5 class="BtnName NameTemp">公版文字<span></span></h5>   
            </div>
        </div>
    </template>
   
    

    
    <script type="module">
        import { $g } from './helpers.js';

        // 一、宣告 + 取得 DOM
        const url = "https://raw.githubusercontent.com/hyeb407/hyeb407.github.io/main/JS_HW5%20Apple/AppleSeries.json";
        
        let uri = './ApplePics/ipadColor/'
        //uri 是色票

        let uri2 = './ApplePics/iphoneColor/'
       
        
        let jsonParseArr = [];
        let colorPic;
        let showPrice;
              
        let picBox = document.querySelector(".pic-box");
        let priceBox = document.querySelector(".price-box");
        let pic = document.querySelector(".pic");
       
        let mainContainer = $g(".main-container")
        let subContainer  =$g("#subContainer")
        let templateColorBtn = $g('#cardBtnColor'); //定義的 Template id
        let btnTemplate = $g('#cardBtn'); //定義的 Template id
        let colorID , btnID
        let allColorBtns, allStorageBtns
        let specAutoArr=[];
        let specAutoArr2=[];
        let ipadSpecArr = [] ,iphoneSpecArr=[], macSpecArr=[];
        let xhr = new XMLHttpRequest();
        let cloneBtn
        let filterArr,filterArr2
        

        //二、分頁監聽事件
        let ipadPageBtn = $g("#ipad").addEventListener("click", function(){
            alert(`加入監聽成功`)
            mainContainer.innerHtml = "";
            getColorBtn()
            getStorageBtn() //放在這裡才收的到取回的 url(JSON資料在雲端)
            getNetworkBtn()                              
        })

        let iphonePageBtn = $g("#iphone").addEventListener("click", function(){
            alert(`加入監聽成功`)
            mainContainer.innerHtml = "";
            getIphoneColorBtn()
            getSIphonetorageBtn()
            getIphoneStyleBtn()
        })

        let macPageBtn = $g("#mac")
        


        //三、方法
        window.onload = function(){
            mainContainer.innerHtml = "";
            getIpadJson(url)
        }

        function getIpadJson(uriii) {
            xhr.onload = function () {
                jsonParseArr = JSON.parse(this.responseText);        
            };
            xhr.open("GET", uriii);
            xhr.send();
        }


        function getColorBtn(){
            //取得資料
            let ipadOutWarddArr=[];             
            ipadOutWarddArr = jsonParseArr.IPad.OutWard;
                //現在是陣列，所以要 forEach 取裡面的 color
                //(5) [{…}, {…}, {…}, {…}, {…}]
                // 0: {color: '太空灰色', colorValue: '#6e6969', imageUrl: './ApplePics/ipadColor/太空灰色.png'}
                // 1: {color: '星光色', colorValue: '#b9aeae', imageUrl: './ApplePics/ipadColor/星光色.png'}
                // 2: {color: '粉紅色', colorValue: '#ceb7a8', imageUrl: './ApplePics/ipadColor/粉紅色.png'}
                // 3: {color: '紫色', colorValue: '#ceb7a8', imageUrl: './ApplePics/ipadColor/紫色.png'}
                // 4: {color: '天藍色', colorValue: '#ceb7a8', imageUrl: './ApplePics/ipadColor/天藍色.png'}
        
            //生成顏色按鈕的格線系統 (DOM 操作)
            ipadOutWarddArr.forEach(item =>{
                allColorBtns = setIpadColorBtnData(item.color ,item.pic)   //顏色 & 平板圖片                              
                let colorBtnSection = document.querySelector("#colorBtnSection");
                colorBtnSection.append(allColorBtns);
                
            })      
        }
        
        function setIpadColorBtnData(item,pic){
            console.log(item) // 太空灰色、星光色、粉紅色、紫色、天藍色
            console.log(pic)  //太空灰色01.jpg

            // <div class="card colorBtn cardTemp" id="太空灰色">
            //     <img src="" class="circle circleTemp">
            //     <h5 class="colorBtnName colorNameTemp">太空灰</h5> 

            // 使用 template 一定要 .content.cloneNode(true)
            cloneBtn = templateColorBtn.content.cloneNode(true); //參數要帶 true 才會層層複製
            colorID= cloneBtn.querySelector(".cardTemp").id = item;
            // console.log(colorID)       
            
            cloneBtn.querySelector(".circleTemp").src = uri+item+'.png'; //uri 路徑已在全域宣告
            cloneBtn.querySelector(".colorNameTemp").innerText = item;
            
            cloneBtn.querySelector(".cardTemp").addEventListener("click" , function(){
                    picBox.innerHTML = getIPadColorPic(pic);           
            });

            return cloneBtn;  //製作好的卡片回覆給呼叫端
        }

        function getIPadColorPic(pic) {
            console.log(pic) //太空灰色01.jpg
            
            let imgUrl = `https://raw.githubusercontent.com/hyeb407/hyeb407.github.io/main/JS_HW5%20Apple/ApplePics/ipad/${pic}`;
            let pics = `
                <img src="${imgUrl}" class="pic" alt=""> `;

            return pics;
        }


        
        function getStorageBtn() { 
            ipadSpecArr = jsonParseArr.IPad.Spec;
        
            //取得不重複的 storage 規格ˇ         
            ipadSpecArr.forEach(item=>{
                if(! specAutoArr.includes(item.storage)){
                     specAutoArr.push(item.storage)
                     console.log(specAutoArr)                                          
                    }
            })
                
            //生成按鈕的格線系統 (DOM 操作) 
            specAutoArr.forEach(item =>{
                allStorageBtns = setBtnData(item)   //64GB , 256GB
                    console.log(item)                                    
                let storageBtnSection = document.querySelector("#storageBtnSection");
                storageBtnSection.append(allStorageBtns);                                                    
            })
            // //掛入監聽事件，按下後過濾資料
            // document.querySelectorAll(".cardTemp2").forEach(node =>{        
            //     console.log(node)
    
            //     node.addEventListener("click" , function(){
            //         console.log(`${item}加裝監聽成功`);                      
            //         filterArr = ipadSpecArr.filter(x=> x.storage==item)
            //         console.log(filterArr)
                    
            //     });           
            // })
        };
               
        function getNetworkBtn() { 
            // ipadSpecArr = jsonParseArr.IPad.Spec;
            console.log(`ipadSpecArr...`)
            console.log(ipadSpecArr);
        
            //取得不重複的 network 規格ˇ         
            ipadSpecArr.forEach(item=>{
                console.log(item)
                if(! specAutoArr2.includes(item.network) ){
                     specAutoArr2.push(item.network)
                     console.log(specAutoArr2)                                   
                    }
                })
                
            //生成按鈕的格線系統 (DOM 操作)
            specAutoArr2.forEach(item =>{
                allStorageBtns = setBtnData(item)   
                    console.log(item)                                    
                let networkBtnSection = document.querySelector("#networkBtnSection");
                networkBtnSection.append(allStorageBtns);              
                //掛入監聽事件，按下後過濾資料
                // document.querySelectorAll(".cardTemp2").forEach(node =>{        
                //     console.log(node)

                //     node.addEventListener("click" , function(){
                //         console.log(`${item}加裝監聽成功`);                      
                //         filterArr2 = filterArr.filter(x=> x.network==item)
                //         console.log(filterArr2)
                        
                //     });           
                // })
            })

        };

        function setBtnData(specValue){
            console.log(specValue) //64G , 256G
            
            // <template id="cardBtn">
            //     <div class="col-6 col-md-6 col-lg-6 col-xl-6">                             
            //         <div class="card cardTemp2" id="每個按鈕的ID">
            //             <h5 class="BtnName NameTemp">公版文字<span></span></h5>   
            //         </div>
            //     </div>
            // </template>

            let cloneBtn = btnTemplate.content.cloneNode(true); //參數要帶 true 才會層層複製
            btnID = cloneBtn.querySelector(".cardTemp2").id = specValue;
            console.log(btnID)
            console.log(specValue)
            cloneBtn.querySelector(".NameTemp").innerText = specValue;
            
            //掛入監聽事件，按下後過濾資料           
            cloneBtn.querySelector(".cardTemp2").addEventListener("click" , function(){
                console.log(`${specValue}加裝監聽成功`);           
                // let refIdx = ipadSpecArr.map(x => Object.keys(x)) [0]; //map 出來的第 0 筆索引值 (本來會有3筆)
                // refIdx = ipadSpecArr.map(x => Object.values(x)) 
                // console.log(refIdx) 
                // refIdx.forEach(x=>{
                //     console.log(x);
                console.log(ipadSpecArr.storage)             
                
                filterArr = ipadSpecArr.filter(x=> x.storage==specValue)
                console.log(filterArr)
                
                if(specValue == "Wi-Fi" || specValue == "Cellular"){
                    filterArr2 = filterArr.filter(x=> x.network==specValue )
                    console.log(filterArr2)
                }
             
                // filterArr.forEach(data => {
                //     showPrice = data.price
                //     console.log(showPrice); 
                // });

            });           

            return cloneBtn;
            //製作好的卡片回覆給呼叫端
        }


        //iPhone
        function getIphoneColorBtn(){
            //取得資料
            let iphoneOutWarddArr=[];             
            iphoneOutWarddArr = jsonParseArr.IPhone.OutWard;
                //現在是陣列，所以要 forEach 取裡面的 color
        
            //生成顏色按鈕的格線系統 (DOM 操作)
            iphoneOutWarddArr.forEach(item =>{
                allColorBtns = setIphoneColorBtnData(item.color ,item.pic)   //顏色 & 平板圖片                              
                let colorBtnSection = document.querySelector("#colorBtnSection");
                colorBtnSection.append(allColorBtns);
                
            })      
        }

        function setIphoneColorBtnData(item,pic){
            console.log(item) // 太空灰色、星光色、粉紅色、紫色、天藍色
            console.log(pic)  //太空灰色01.jpg

            // <div class="card colorBtn cardTemp" id="太空灰色">
            //     <img src="" class="circle circleTemp">
            //     <h5 class="colorBtnName colorNameTemp">太空灰</h5> 

            // 使用 template 一定要 .content.cloneNode(true)
            cloneBtn = templateColorBtn.content.cloneNode(true); //參數要帶 true 才會層層複製
            colorID= cloneBtn.querySelector(".cardTemp").id = item;
            // console.log(colorID)       

            cloneBtn.querySelector(".circleTemp").src = uri2+item+'.jpg'; //uri 路徑已在全域宣告
            cloneBtn.querySelector(".colorNameTemp").innerText = item;
            
            cloneBtn.querySelector(".cardTemp").addEventListener("click" , function(){
                    picBox.innerHTML = getIPhoneColorPic(pic);           
            });

            return cloneBtn;  //製作好的卡片回覆給呼叫端
        }
    
        function getIPhoneColorPic(pic) {
            console.log(pic) //太空灰色01.jpg
            
            let imgUrl = `https://raw.githubusercontent.com/hyeb407/hyeb407.github.io/main/JS_HW5%20Apple/ApplePics/iphone14/${pic}`;
            let pics = `
                <img src="${imgUrl}" class="pic" alt=""> `;

            return pics;
        }
    
        function getSIphonetorageBtn() { 
            iphoneSpecArr = jsonParseArr.IPhone.Spec;
        
            //取得不重複的 storage 規格ˇ         
            iphoneSpecArr.forEach(item=>{
                if(! specAutoArr.includes(item.storage)){
                     specAutoArr.push(item.storage)
                     console.log(specAutoArr)                                          
                    }
            })
                
            //生成按鈕的格線系統 (DOM 操作) 
            specAutoArr.forEach(item =>{
                allStorageBtns = setBtnData(item)   //64GB , 256GB
                    console.log(item)                                    
                let storageBtnSection = document.querySelector("#storageBtnSection");
                storageBtnSection.append(allStorageBtns);                                                    
            })
        };

        function getIphoneStyleBtn() {        
            //取得不重複的 network 規格ˇ         
            iphoneSpecArr.forEach(item=>{
                if(! specAutoArr2.includes(item.style) ){
                     specAutoArr2.push(item.style)                               
                    }
                })
                
            //生成按鈕的格線系統 (DOM 操作)
            specAutoArr2.forEach(item =>{
                allStorageBtns = setBtnData(item)   
                    console.log(item)                                    
                let styleBtnSection = document.querySelector("#styleBtnSection");
                styleBtnSection.append(allStorageBtns);              
            })

        };

        function setIphoneBtnData(specValue){
            console.log(specValue) //64G , 256G
            
            // <template id="cardBtn">
            //     <div class="col-6 col-md-6 col-lg-6 col-xl-6">                             
            //         <div class="card cardTemp2" id="每個按鈕的ID">
            //             <h5 class="BtnName NameTemp">公版文字<span></span></h5>   
            //         </div>
            //     </div>
            // </template>

            let cloneBtn = btnTemplate.content.cloneNode(true); //參數要帶 true 才會層層複製
            btnID = cloneBtn.querySelector(".cardTemp2").id = specValue;
            console.log(btnID)
            console.log(specValue)
            cloneBtn.querySelector(".NameTemp").innerText = specValue;
            
            //掛入監聽事件，按下後過濾資料           
            cloneBtn.querySelector(".cardTemp2").addEventListener("click" , function(){
                console.log(`${specValue}加裝監聽成功`);           
                
                console.log(iphoneSpecArr.storage)             
                
                filterArr = iphoneSpecArr.filter(x=> x.storage==specValue)
                console.log(filterArr)
                
                if(specValue == "Wi-Fi" || specValue == "Cellular"){
                    filterArr2 = filterArr.filter(x=> x.network==specValue )
                    console.log(filterArr2)
                }
   
            });
        }



         //mac
         function getIphoneColorBtn(){
            //取得資料
            let iphoneOutWarddArr=[];             
            iphoneOutWarddArr = jsonParseArr.MacAir.OutWard;
                //現在是陣列，所以要 forEach 取裡面的 color
        
            //生成顏色按鈕的格線系統 (DOM 操作)
            iphoneOutWarddArr.forEach(item =>{
                allColorBtns = setIphoneColorBtnData(item.color ,item.pic)   //顏色 & 平板圖片                              
                let colorBtnSection = document.querySelector("#colorBtnSection");
                colorBtnSection.append(allColorBtns);
                
            })      
        }

        function setIphoneColorBtnData(item,pic){
            console.log(item) // 太空灰色、星光色、粉紅色、紫色、天藍色
            console.log(pic)  //太空灰色01.jpg

            // <div class="card colorBtn cardTemp" id="太空灰色">
            //     <img src="" class="circle circleTemp">
            //     <h5 class="colorBtnName colorNameTemp">太空灰</h5> 

            // 使用 template 一定要 .content.cloneNode(true)
            cloneBtn = templateColorBtn.content.cloneNode(true); //參數要帶 true 才會層層複製
            colorID= cloneBtn.querySelector(".cardTemp").id = item;
            // console.log(colorID)       

            cloneBtn.querySelector(".circleTemp").src = uri2+item+'.jpg'; //uri 路徑已在全域宣告
            cloneBtn.querySelector(".colorNameTemp").innerText = item;
            
            cloneBtn.querySelector(".cardTemp").addEventListener("click" , function(){
                    picBox.innerHTML = getIPhoneColorPic(pic);           
            });

            return cloneBtn;  //製作好的卡片回覆給呼叫端
        }
    
        function getIPhoneColorPic(pic) {
            console.log(pic) //太空灰色01.jpg
            
            let imgUrl = `https://raw.githubusercontent.com/hyeb407/hyeb407.github.io/main/JS_HW5%20Apple/ApplePics/iphone14/${pic}`;
            let pics = `
                <img src="${imgUrl}" class="pic" alt=""> `;

            return pics;
        }
    
        function getSIphonetorageBtn() { 
            iphoneSpecArr = jsonParseArr.IPhone.Spec;
        
            //取得不重複的 storage 規格ˇ         
            iphoneSpecArr.forEach(item=>{
                if(! specAutoArr.includes(item.storage)){
                     specAutoArr.push(item.storage)
                     console.log(specAutoArr)                                          
                    }
            })
                
            //生成按鈕的格線系統 (DOM 操作) 
            specAutoArr.forEach(item =>{
                allStorageBtns = setBtnData(item)   //64GB , 256GB
                    console.log(item)                                    
                let storageBtnSection = document.querySelector("#storageBtnSection");
                storageBtnSection.append(allStorageBtns);                                                    
            })
        };

        function getIphoneStyleBtn() {        
            //取得不重複的 network 規格ˇ         
            iphoneSpecArr.forEach(item=>{
                if(! specAutoArr2.includes(item.style) ){
                     specAutoArr2.push(item.style)                               
                    }
                })
                
            //生成按鈕的格線系統 (DOM 操作)
            specAutoArr2.forEach(item =>{
                allStorageBtns = setBtnData(item)   
                    console.log(item)                                    
                let styleBtnSection = document.querySelector("#styleBtnSection");
                styleBtnSection.append(allStorageBtns);              
            })

        };

        function setIphoneBtnData(specValue){

    
    </script>
</body>
</html>