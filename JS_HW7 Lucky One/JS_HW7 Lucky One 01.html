<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./grid.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        i{
            font-size: 36px;
        }

        [box-id]{
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: 0.3s;
        }

        [box-id].active{
            border: 3px dashed #00E6E6;
            box-shadow: 0 0 20 gray;
            transition: 0s;
        }

        button{
            border: none;
            color: #00E6E6;
        }

        #msg{
            font-size: 36px;
            text-align: center;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="row">
            <div box-id="1" class="col-1"><i class="fa-solid fa-fish-fins"></i></div>
            <div box-id="2" class="col-1"><i class="fa-solid fa-kiwi-bird"></i></div>
            <div box-id="3" class="col-1"><i class="fa-solid fa-church"></i></div>
            <div box-id="4" class="col-1"><i class="fa-solid fa-person-through-window"></i></div>
            <div box-id="5" class="col-1"><i class="fa-solid fa-cloud-bolt"></i></i></div>
            <div box-id="6" class="col-1"><i class="fa-solid fa-ranking-star"></i></div>
            <div box-id="7" class="col-1"><i class="fa-solid fa-house-chimney"></i></div>
            <div box-id="8" class="col-1"><i class="fa-solid fa-sack-dollar"></i></div>
            <div box-id="9" class="col-1"><i class="fa-solid fa-cow"></i></div>
            <div box-id="10" class="col-1"><i class="fa-solid fa-parachute-box"></i></div>
            <div box-id="11" class="col-1"><i class="fa-solid fa-volcano"></i></div>
            <div box-id="12" class="col-1"><i class="fa-solid fa-bowl-rice"></i></div>
        </div>

        <div class="row">
            <div box-id="32" class="col-1"><i class="fa-solid fa-car-on"></i></div>
            <div id="msg" class="col-10"></div>
            <div box-id="13" class="col-1"><i class="fa-solid fa-plane-up"></i></div>
        </div>

        <div class="row">
            <div box-id="31" class="col-1"><i class="fa-solid fa-burst"></i></div>
            <div id=""  class="col-10"></div>
            <div box-id="14" class="col-1"><i class="fa-solid fa-light fa-wand-magic-sparkles"></i></div>
        </div>

        <div class="row">
            <div box-id="30" class="col-1"><i class="fa-solid fa-cloud-bolt"></i></div>
            <div id=""  class="col-10"></div>
            <div box-id="15" class="col-1"><i class="fa-solid fa-bowl-rice"></i></div>
        </div>

        <div class="row">
            <div box-id="29" class="col-1"><i class="fa-solid fa-plane-up"></i></div>
            <div id="" class="col-3"></div>
            <button id="" class="col-4">START</button>
            <div id="" class="col-3"></div>
            <div box-id="16" class="col-1"><i class="fa-solid fa-cloud-bolt"></i></div>
        </div>

        <div class="row">
            <div box-id="28" class="col-1"><i class="fa-sharp fa-solid fa-truck-fast"></i></div>
            <div box-id="27" class="col-1"><i class="fa-solid fa-kiwi-bird"></i></div>
            <div box-id="26" class="col-1"><i class="fa-sharp fa-solid fa-lemon"></i></div>
            <div box-id="25" class="col-1"><i class="fa-solid fa-light fa-person"></i></div>
            <div box-id="24" class="col-1"><i class="fa-sharp fa-solid fa-bath"></i></div>
            <div box-id="23" class="col-1"><i class="fa-sharp fa-solid fa-bug"></i></div>
            <div box-id="22" class="col-1"><i class="fa-solid fa-fish-fins"></i></i></div>
            <div box-id="21" class="col-1"><i class="fa-solid fa-kiwi-bird"></i></div>
            <div box-id="20" class="col-1"><i class="fa-solid fa-kiwi-bird"></i></div>
            <div box-id="19" class="col-1"><i class="fa-solid fa-car-on"></i></div>
            <div box-id="18" class="col-1"><i class="fa-solid fa-ranking-star"></i></div>
            <div box-id="17" class="col-1"><i class="fa-sharp fa-solid fa-icons"></i></div>
        </div>

    </div>
    <script>

        const brickData = [
                    {
                        id:"1",
                        color:"#00E6E6",
                        icon: "fa-solid fa-fish-fins",
                        target: function(){
                            return '1 恭喜你!獲得一隻可以做成生魚片的高級魚!'
                        }
                    },
                    {
                        id:"2",
                        color:"#EBEB00",
                        icon: "fa-thin fa-kiwi-bird",
                        target: function(){
                            return '2 這裡甚麼也沒有..他只是一隻無辜的奇異鳥...'
                        }
                    },
                    {
                        id:"3",
                        color:"#EBEB00",
                        icon: "fa-sharp fa-light fa-angel",
                        target: function(){
                            return '3 「天使保佑」是Hook 最常說的台詞，他是我喜愛的Youtuber之一，穿梭古今中外的歷史系才女，以輕鬆詼諧的腳本讓你在無意間攝取歷史養分，同時達到放空療癒身心之妙用，一舉兩得，推薦給你！'
                        }
                    },
                    {
                        id:"4", color:"#EBEB00", icon: "",
                        target: function(){
                            return '4'
                        }
                    },
                    {
                        id:"5",
                        color:"lightgreen",
                        icon: "",
                        target: function(){
                            return '5'
                        }
                    },
                    {
                        id:"6",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '6'
                        }
                    },
                    {
                        id:"7",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '7'
                        }
                    },
                    {
                        id:"8",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '9'
                        }
                    },
                    {
                        id:"9",
                        color:"lightgreen",
                        icon: "",
                        target: function(){
                            return '9 現今入袋，恭喜你成為大富翁世界的大富翁，但現實...'
                        }
                    },
                    {
                        id:"10",
                        color:"#00E6E6",
                        icon: "",
                        target: function(){
                            return '10'
                        }
                    },
                    {
                        id:"11",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '11'
                        }
                    },
                    {
                        id:"12",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '12'
                        }
                    },
                    {
                        id:"13",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '13'
                        }
                    },{
                        id:"14",
                        color:"#00E6E6",
                        icon: "",
                        target: function(){
                            return '14 只能變出香菸的魔術棒'
                        }
                    },
                    {
                        id:"15",
                        color:"lightgreen",
                        icon: "",
                        target: function(){
                            return '15 你知道為什麼韓國每餐都有小菜呢？ 因為戰後缺糧，米飯成為珍貴食物，而蔬菜漁獲類得以醃漬保存的關係喔~'
                        }
                    },
                    {
                        id:"16",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '16'
                        }
                    },
                    {
                        id:"17",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '17'
                        }
                    },
                    {
                        id:"18",
                        color:"#00E6E6",
                        icon: "",
                        target: function(){
                            return '18'
                        }
                    },
                    {
                        id:"19",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '19'
                        }
                    },
                    {
                        id:"20",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '20 這裡甚麼也沒有..他只是一隻無辜的奇異鳥...'
                        }
                    },
                    {
                        id:"21",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '21 這裡甚麼也沒有..他只是一隻無辜的奇異鳥...'
                        }
                    },
                    {
                        id:"22",
                        color:"#00E6E6",
                        icon: "",
                        target: function(){
                            return '22'
                        }
                    },
                    {
                        id:"23",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '23 他只是一隻bug，請不要de他..'
                        }
                    },
                    {
                        id:"24",
                        color:"lightgreen",
                        icon: "",
                        target: function(){
                            return '24'
                        }
                    },
                    {
                        id:"25",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '25'
                        }
                    },
                    {
                        id:"26",
                        color:"lightgreen",
                        icon: "",
                        target: function(){
                            return '26'
                        }
                    },
                    {
                        id:"27",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '27 這裡甚麼也沒有..他只是一隻無辜的奇異鳥...'
                        }
                    },
                    {
                        id:"28",
                        color:"#00E6E6",
                        icon: "",
                        target: function(){
                            return '28'
                        }
                    },
                    {
                        id:"29",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '29'
                        }
                    },
                    {
                        id:"30",
                        color:"#EBEB00",
                        icon: "",
                        target: function(){
                            return '30'
                        }
                    },
                    {
                        id:"31",
                        color:"#00E6E6",
                        icon: "",
                        target: function(){
                            return '31'
                        }
                    },
                    {
                        id:"32",
                        color:"lightgreen",
                        icon: "",
                        target: function(){
                            return '32'
                        }
                    }
                ]

        //宣告
        let steps = 0;
        let allsteps = 0; //全部的步數
        let currentIdx = 0; //目前走到哪一格
        let speed;  //速率，越大表示越慢
        let bricks
        let msg = document.querySelector("#msg")


        //設定 brick 的裡面資料
        let brickNodes = document.querySelectorAll("[box-id]");
        console.log(brickNodes) //是節點集合 NodeList(32)
        bricks =[...brickNodes].sort( (a,b) =>{
            return a.getAttributeNode("box-id").value - b.getAttributeNode("box-id").value;         
            //他要 return 回 bricks 自己，所以不要再宣告一個變數
            //return 一定要直接放在那串 code 之前...
        })
        console.log(bricks) //現在是陣列

        
        bricks.forEach((item,idx) => {
            //我要為每一個 brick 加上資料表設定的顏色
            let brickID = idx +1; //讓陣列裡 brick 的索引從 1 開始，所以要加一
            let data = brickData.find(data => data.id == brickID);
            console.log(data)
            item.style.color = data.color
        })

        
        //開始按鈕
        document.querySelector("button").addEventListener("click", function(){
            getSteps();
            turnAround();
        })

        //方法
        function getSteps(){
            //取得亂數，0 ~ 32 之間，讓他不要停在，讓他不要停在第一格
            let random = Math.floor(Math.random() * brickData.length + 1)
            console.log(random)
            //設定要走的步數
            steps = random + (brickData.length *3)
            //因為要讓 step 遞減歸零，所以要再取一個總步數，用來放慢角度 (搭配 speed)
            allsteps= steps;
            //速度
            speed = 50
        }

        function turnAround(){
            //要自動讓他自動化
            console.log(`This is allsteps： ${steps} ............`)

            for(let i=1; i < (steps+1)/2; i++){
                //走每一步，都會去執行一次 active移除 & 增加
                //立即實行沒用，快的還是會先跑
                //加上 else ，剩餘 step 會有錯
                (function(t){ 
                    setTimeout(()=>{
                        // console.log(`迴圈一的i圈數：${i}...`)
                        // console.log(`before+ active的 currentIdx：${currentIdx}`)                     
                        bricks[currentIdx].classList.remove("active");
                        currentIdx++;
                    
                    // for(let i=0; i > brickData.length; steps--){
                        // console.log(currentIdx)
                        if(currentIdx >= brickData.length){
                            currentIdx=0
                        }  
                        // else{
                            bricks[currentIdx].classList.add("active");
                            // console.log(`after+ active的 currentIdx：${currentIdx}`)                   
                            steps = steps -1;
                            // console.log(`steps--的：${steps}...`)                           
                            
                            // }
                            
                            if(steps== 0){                       
                            msg.innerText = brickData[currentIdx].target();                        
                               }

                        },60*i)
                    })(i)
                    
                
                }

            for(let i=0; i < allsteps - steps/2; i++){
                //走每一步，都會去執行一次 active移除 & 增加
               
                    setTimeout(()=>{
                        // console.log(`迴圈二i圈數：${i}...`)
                        console.log(`before+ active的 currentIdx：${currentIdx}`)                     
                        bricks[currentIdx].classList.remove("active");
                        currentIdx++;
                    
                    // for(let i=0; i > brickData.length; steps--){
                        // console.log(currentIdx)
                        if(currentIdx >= brickData.length){
                            currentIdx=0
                        }  
                        // else{
                            bricks[currentIdx].classList.add("active");
                            // console.log(`after+ active的 currentIdx：${currentIdx}`)                   
                            steps = steps -1;
                            // console.log(`steps--的：${steps}...`)   
                        // }
        
                    },40*i)
                  
            }


              
    
            //助教版
            // bricks[currentIdx].classList.remove("active");
            // currentIdx++;
            
            // if (currentIdx >= bricks.length){
            //     currentIdx = 0
            // }           
            // bricks[currentIdx].classList.add("active");
            // steps--;
            // console.log(currentIdx)
            // console.log(steps)

            // if (steps > 0){
            //     setTimeout(turnAround, speed);
                
            //     if (steps < Math.floor((allsteps / 3))) {
            //         speed = 100;
            //     }
            // }
            // else{
            //     //走完了
            //     msg.innerText = brickData[currentIdx].target();
            // }
                                    
        }


        



    </script>
</body>
</html>